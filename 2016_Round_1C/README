B and C solved after the contest.